// SPDX-License-Identifier: UNLICENSED
pragma solidity ^0.8.13;
 
import "@pythnetwork/pyth-sdk-solidity/IPyth.sol";
 
contract PriceFeed {
    IPyth pyth;
    bytes32 ethUsdPriceId;
    bytes32 btcUsdPriceId;
 
    constructor(address pythAddress) {
        pyth = IPyth(address(pythAddress));
        ethUsdPriceId = bytes32(0xff61491a931112ddf1bd8147cd1b641375f79f5825126d665480874634fd0ace);
        btcUsdPriceId = bytes32(0xe62df6c8b4a85fe1a67db44dc12de5db330f7ac66b72dc658afedf0f4a415b43);
    }

    function updateBtcUsdPrice() external payable {
        bytes[] memory updateData = new bytes[](1);
        updateData[0] = hex"504e41550100000003b801000000040d000900a3515a0dca4a1314addc79d5bd8a31d934d5697dad4d5b42fd383c1000a40bced31e67b81f2da8320cc8d181298bc822c65687cc1c53dc9c995800c2a0a20001d2400cbd74b0b4a5b4ca77fe5d4b29feb23797275a03234df904cea05b674bab3385933a6d95b4ce0a97df3d8f84916f518a9cc141a27e1097ecffc42347ea740002cd4285697b4fee96c907913d2711a9b854d1a0085b01eca318f0afba4931cfe96cc55136be49df37381c0b6261a3384bb6a9e5bb0995df8b46247da1a69c20c500033d44ed12e984638371c63b3662e5fedd96796b0394415257dc0b51c7432d2bd63fcb41aabe4374b68571227153d5e02b5194375ebc32fb5c4d329176ce4b5ef601061cfc8b233a3ca1fb30a2717b4246cb94afd79e055ce82fc72cf2501284d7b7440da8679c9fe4a7a25bdff95179b28a90e77851e29b9f6cd42af0ba415e0be35e010a1d82c0b81a45505e978d70551780e21ba956346617f578749f4b51837ad12cbd6fb3d0d0cd83efec17733d4aadcc1becc28bb6c50605e3a62d0810c893aafbb7010b8e4f0a0a4a01a6a011564926fb51902593a9e957804fbcce983a361f61274c7d5a9f5e8933dac3ed28e3d085853341b3659dbc0d6228049328c073b50b65a23a010c42b23dbf8358b05e59117ed789a40d9d03e46b1226368f523664ab3cd69d9cb5084b42d600aaf3648eaa8646173a165a410e6b860e64c4c0ca3aae5bd07a7bdf000dd6dc1f0f56d5fb9db4bf45d4d230c4247d4f873c48020175b5f80b043fe3754b6f5751717daa0bb1b7602fa2557ad912209f751830991a27292ee76bab8ad80b000e063879c4eee965f5293170e1cfaf59d0e7c9750aaef898a3c22db74b4cdd0d55206ec71bb03a820245504d2572513f84d5d473c29179845234fa744293ffaf2d000fed77f516526dec97aa387b8ffd5029be3876634c09ceffc59ee5be13c17b2cd13bc368598eeb71a3d1d041c7428a50143185f2ab3f54b991f481ec9effbc0cd80011a9ae00d1887cbbdd36cd2803dccbda8278f3af061060faefc9cb1c78a1c5c9101505980562412682133bbfff95736db924ee0457efd00b79d7385bdfd3edcee10112bc6c18fb6164b4cb45091b60b2aad303ccda601618e304a8f64c3bf62b3383c422291ff643e4362692c892646d2e796837791b36edab961d082d8e064e78f21d016675470d00000000001ae101faedac5851e32b9b23b5f9411a8c2bac4aae3ed4dd7b811dd1a72ea4aa710000000003d5e2760141555756000000000008e0329c000027109a70f48fe45322701979bd289b35c4d5813c902901005500e62df6c8b4a85fe1a67db44dc12de5db330f7ac66b72dc658afedf0f4a415b43000005cc2280e30c00000001932ff3d4fffffff8000000006675470c000000006675470c000005d3dd16d76000000001648f3d8c0aafc8174247130e68b0f507935a2309964ef94ea952d44e04cfffe5a5fa627fc6e3bdb61466f399f7662aa7307085a6b944196c2b13a93b990f755453bb8de8fb245a447752a37d38b8763a632223512b74c85e7a0dfbd2aba11c4b05e58eaa196791c6e7411dc0c551455490e4261635b5920fa0134d5d394428a4c1c2213d35233f423c0b928fa63b362c00c22840dd317cbb6e5bee41c08855a5fd1fe10f2eb8d4116df41f67006c61e1a54c43c0320e0f11e2336973d4dfb710781c1c11dca7a10caeaf204e1f";
        uint fee = 1;
        pyth.updatePriceFeeds{value: fee}(updateData);
    }

    function getBtcUsdPrice() public view returns (int64 price, int32 expo, uint256 publishTime) {
        PythStructs.Price memory priceStruct = pyth.getPriceUnsafe(btcUsdPriceId);
        return (priceStruct.price, priceStruct.expo, priceStruct.publishTime);
    }

    function getEthUsdPrice() public view returns (int64 price, int32 expo, uint256 publishTime) {
        PythStructs.Price memory priceStruct = pyth.getPriceUnsafe(ethUsdPriceId);
        return (priceStruct.price, priceStruct.expo, priceStruct.publishTime);
    }
}
